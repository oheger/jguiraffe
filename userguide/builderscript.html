<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.2 from src/site/xdoc/userguide/builderscript.xml at 2022-11-05

 | Rendered using Apache Maven Default Skin
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.2" />
    <meta name="author" content="Oliver Heger" />
    <title>JGUIraffe &#x2013; A complete builder script</title>
    <link rel="stylesheet" href="../css/maven-base.css" />
    <link rel="stylesheet" href="../css/maven-theme.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />
  </head>
  <body class="composite">
    <div id="banner">
<a href=".././" id="bannerLeft"><img src="../images/giraffe.jpg"  alt="JGUIraffe"/></a>      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2022-11-05</span>
          &#xA0;| <span id="projectVersion">Version: 1.4.1</span>
      </div>
      <div class="xright"><a href=".././" title="GitHub project">GitHub project</a>      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
       <h5>JGuiraffe</h5>
    <ul>
     <li class="none"><a href="../index.html" title="Home">Home</a></li>
     <li class="none"><a href="../introduction.html" title="Introduction">Introduction</a></li>
     <li class="none"><a href="../overview.html" title="Overview">Overview</a></li>
     <li class="none"><a href="../userguide/user_guide.html" title="User's Guide">User's Guide</a></li>
     <li class="none"><a href="../apidocs/index.html" title="Javadoc (latest)">Javadoc (latest)</a></li>
     <li class="none"><a href="../jguiraffe-parent/jguiraffe-examples/index.html" title="JGUIraffe Examples">JGUIraffe Examples</a></li>
     <li class="none"><a href="../building.html" title="Building from Source">Building from Source</a></li>
     <li class="none"><a href="../jguiraffe-parent/jguiraffe/changes-report.html" title="Changes Report">Changes Report</a></li>
    </ul>
       <h5>Modules</h5>
    <ul>
     <li class="none"><a href="../jguiraffe-parent/jguiraffe/index.html" title="JGUIraffe Core">JGUIraffe Core</a></li>
     <li class="none"><a href="../jguiraffe-parent/jguiraffe-swing/index.html" title="JGUIraffe Swing integration">JGUIraffe Swing integration</a></li>
     <li class="none"><a href="../jguiraffe-parent/jguiraffe-java-fx/index.html" title="JGUIraffe JavaFX integration">JGUIraffe JavaFX integration</a></li>
    </ul>
      <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="../images/logos/maven-feather.png" />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">


 
  <section>
<h2><a name="A_complete_builder_script"></a>A complete builder script</h2>
  
<p>
    In the previous chapters the various elements that can appear in a builder
    script - bean declarations, form elements, actions, windows, etc. - have
    been discussed. There have also been plenty examples demonstrating the usage
    of the tags provided by the <i>JGUIraffe</i> tag libraries. However, these
    have only been short code fragments focusing on the element(s) just under
    discussion. What is missing so far is a full example of a builder script.
    Such an example is the subject of this chapter.
  </p>
  
<p>
    Having a full example of a builder script is indeed useful because there are
    certain requirements regarding the order in which elements are declared. The
    script is processed in a single pass from its beginning to its end. So as a
    rule of thumb, elements must be declared before they can be referenced by
    other elements. There are some exceptions from this rule, however. Bean
    declarations for instance do not create the corresponding objects directly.
    The creation happens on first access through a <code>BeanContext</code>, and
    then all dependencies are resolved automatically. As long as there are no
    cyclic dependencies between beans (refer to the section
    <a href="dibuilder.html#Cyclic_dependencies">Cyclic dependencies</a>),
    dependent beans can be placed in any order.
  </p>
  
<p>
    In the following sub sections a full builder script defining a simple dialog
    window will be developed. We first present single blocks of the script that
    deal with a specific topic. At the end of the chapter the script is again
    printed as a whole. The order of the single blocks can be adapted as a
    common pattern. It takes logic dependencies between the different elements
    into account and complies to the ordering requirements mentioned above.
  </p>
  
<p>
    The example script discussed in this chapter has already been partly
    presented in other chapters of this guide. It defines a dialog window whose
    purpose it is to create a new text file. The dialog provides the following
    features:
    </p>
<ul>
      
<li>A pretty simple UI consisting mainly of a text field for entering the
      file name and a text area for defining the content of the file.</li>
      
<li>Buttons for creating the new file and for canceling the operation.</li>
      
<li>Validation support: The input field for the file name is associated
      with multiple validators. It must be filled out, the entered file name
      must not aleady exist in the current directory, and it is checked for
      illegal characters. For the text area just a warning is issued if it is
      empty. Also, invalid fields should be marked, so that it is easy to
      recognize that they contain incorrect data.</li>
      
<li>The text area has a popup menu with some operations.</li>
      
<li>Actions are provided for inserting predefined text fragments into the
      text area. These fragments are also defined in the builder script.</li>
      
<li>The dialog window has a form controller which is responsible for the
      form's life-cycle. The default <code>FormController</code> class provided
      by the framework is used, so no controller logic has to be implemented.</li>
    </ul>
  
  
<p>
    The following screenshot shows the example dialog window in action:
  </p>
  <img src="../images/userguide/CreateFileDialog.png" alt="Example dialog window" />

  <section>
<h3><a name="Bean_declarations"></a>Bean declarations</h3>
  
<p>
    The builder script starts with the definition of some beans that are used by
    UI components as helper classes. Such beans do not have references to
    graphical elements defined in this script. Therefore they can be put at the
    very top. First the bean acting as the form's model and the command object
    to be triggered when the user clicks the OK button are defined:
  </p>
    
<div class="source">
<pre>
  &lt;!-- The form bean. This object acts as the model of the dialog.--&gt;
  &lt;di:bean name=&quot;createFileModel&quot;
    beanClass=&quot;net.sf.jguiraffe.examples.tutorial.createfile.CreateFileData&quot;/&gt;

  &lt;!-- The command to be executed when the OK button is pressed. --&gt;
  &lt;di:bean name=&quot;okCommand&quot;
    beanClass=&quot;net.sf.jguiraffe.examples.tutorial.createfile.CreateFileCommand&quot;&gt;
    &lt;di:constructor&gt;
      &lt;di:param refName=&quot;jguiraffe.applicationContext&quot;/&gt;
      &lt;di:param refName=&quot;createFileModel&quot;/&gt;
      &lt;di:param refName=&quot;action:editRefreshAction&quot;/&gt;
    &lt;/di:constructor&gt;
  &lt;/di:bean&gt;
    </pre></div>
  
<p>
    The bean named <i>createFileModel</i> is a simple Java bean defining get
    and set methods corresponding to the input fields of the form. It basically
    has two properties of type String for the two text fields in the dialog -
    there is no additional logic. For database-centric applications an entity
    class could be used, too. Declaring the form model as a bean has the
    advantage that it is automatically created and is available to all components
    that need access to it. Note that it is a <i>singleton</i> bean, so only a
    single instance is created, and all referencing components share the same
    instance.
  </p>
  
<p>
    <i>Note: What happens if the builder script is executed multiple times, e.g.
    if the user wants to create a number of files? Will there still be only a
    single instance of the model bean? The answer is no. Everytime the dialog
    window is closed all singleton beans in the bean context are freed. The next
    time the builder script is processed again new instances are created. This
    is what we want in this case: when the dialog opens it starts with empty
    input fields. If a dialog's purpose is to edit an existing data object,
    the model has to be created and populated before the builder script is
    executed. It can then be passed to the builder as a property of the
    <code><a href="../apidocs/net/sf/jguiraffe/gui/app/ApplicationBuilderData.html">
    ApplicationBuilderData</a></code> object.</i>
  </p>
  
<p>
    After that another bean is defined which serves as the command to be
    executed when the user clicks the OK button. In this example a custom
    command implementation, <code>CreateFileCommand</code> is used. We do not
    show this class here, it is not too complicated. It creates the file as
    specified by the input fields of the dialog. The directory in which the file
    is created is obtained from the global <code>ApplicationContext</code>
    object passed to the constructor - storing global state of the application
    is a typical use case of the
    <code><a href="../apidocs/net/sf/jguiraffe/gui/app/ApplicationContext.html">
    ApplicationContext</a></code> class. Two points are worth a remark:
    </p>
<ol style="list-style-type: decimal">
      
<li>The command object is passed the model of the form as constructor
      argument. This model object contains all information needed by the command
      to fulfill its task. Therefore no references to other components of the
      UI are required. Passing the form model to the command object is a pretty
      straightforward way of interchanging data between the form and the
      processing command. This is a non-instrusive approach because the command
      does not need to know the form controller or other framework classes for
      this purpose. Just the application-specific model object is passed.</li>
      
<li>In this example, an action is passed to the command object; it is the
      action for refreshing the current directory. This action is not defined in
      the current builder script, it stems from the parent bean context. The
      background is that if a new file is created, the directory listing
      maintained by the application has to be updated. Therefore the command
      triggers this action after its successful execution. It is noteworthy how
      the action is referenced when it is passed as constructor argument to the
      command bean.</li>
    </ol>
  
  
<p>
    Next there are some bean definitions for validators that will later be used
    by input components:
  </p>
    
<div class="source">
<pre>
  &lt;!-- A validator for required input fields.--&gt;
  &lt;di:bean name=&quot;requiredValidator&quot;
    beanClass=&quot;net.sf.jguiraffe.transform.RequiredValidator&quot;&gt;
  &lt;/di:bean&gt;

  &lt;!-- A regular expression validator for validating a file name. Certain
       characters are not allowed in file names.
  --&gt;
  &lt;di:bean name=&quot;fileNameValidator&quot;
    beanClass=&quot;net.sf.jguiraffe.transform.RegexValidator&quot;&gt;
    &lt;di:setProperty property=&quot;regex&quot; value=&quot;[^\*\\/~\|&amp;lt;&amp;gt;]*&quot;/&gt;
  &lt;/di:bean&gt;
    </pre></div>
  
<p>
    Validators are normal beans which can be created using the tags of the
    dependency injection framework. Alternatively, they can be created by
    <code>&lt;f:validator&gt;</code> tags directly. Using the
    <code>&lt;di:bean&gt;</code> tag provides more features. Also, because most
    validators can be shared between multiple components, it makes sense to
    define them globally and reference them from the corresponding input
    elements. If an application uses some specialized custom validators, they
    can be declared in the top-level builder script and are then available in
    all other builder scripts through the parent bean context.
  </p>
  
<p>
    For this example we define an instance of <code>RequiredValidator</code>
    which checks that an input field is not empty. Then a specialized validator
    for checking the file name input field is declared. It ensures that the
    field does not contain any of the invalid characters. We will see below how
    these validators are associated with input fields.
  </p>
  </section>

  <section>
<h3><a name="Actions_and_menus"></a>Actions and menus</h3>
  
<p>
    The next block in the builder script is concerned with action definitions.
    Because the window under construction is just a simple dialog box there is
    neither a main menu nor a tool bar. However, the text area input element has
    a popup menu which is defined using actions.
  </p>
    
<div class="source">
<pre>
  &lt;!-- Action for clearing the content text field. --&gt;
  &lt;a:action name=&quot;clearContentAction&quot; textres=&quot;newfile_act_clear_text&quot;
    mnemonicres=&quot;newfile_act_clear_mnemo&quot; taskBean=&quot;clearTask&quot;/&gt;

  &lt;!-- Action for adding lorem ipsum to the content text field. --&gt;
  &lt;a:action name=&quot;addContentLoremIpsumAction&quot; textres=&quot;newfile_act_loremipsum_text&quot;
    mnemonicres=&quot;newfile_act_loremipsum_mnemo&quot; taskBean=&quot;addLoremIpsumTask&quot;/&gt;

  &lt;!-- Action for adding XML to the content text field. --&gt;
  &lt;a:action name=&quot;addContentXMLAction&quot; textres=&quot;newfile_act_xml_text&quot;
    mnemonicres=&quot;newfile_act_xml_mnemo&quot; taskBean=&quot;addXMLTask&quot;/&gt;

  &lt;!-- Action for adding HTML to the content text field. --&gt;
  &lt;a:action name=&quot;addContentHTMLAction&quot; textres=&quot;newfile_act_html_text&quot;
    mnemonicres=&quot;newfile_act_html_mnemo&quot; taskBean=&quot;addHTMLTask&quot;/&gt;

  &lt;!-- Action data definition for the append sub menu in the popup menu --&gt;
  &lt;a:actionData textres=&quot;newfile_men_append_text&quot;
    mnemonicres=&quot;newfile_men_append_mnemo&quot; var=&quot;menuAppend&quot;/&gt;
    </pre></div>
  
<p>
    The actions defined here are related to clearing the text area for the new
    file's content and for inserting specific text fragments. The
    <code>&lt;a:action&gt;</code> tags define the typical visual properties of
    their actions, e.g. a name, a text label, and a mnemonic. Icons are not used
    here, but would also be allowed.
  </p>
  
<p>
    An interesting point are the references to the actions' tasks specified by
    the <code>taskBean</code> attributes. The beans referenced here have not yet
    been declared in the builder script. Actually, action task definitions
    belong to the exceptional elements in builder scripts that support forward
    references. There is a good reason for this: Beans used as tasks for actions
    frequently require access to graphical elements defined in the same builder
    script - a typical use case for an action is to manipulate parts of the UI.
    So to create the task beans, references to those elements have to be
    injected. In such a constellation it is easy to construct cyclic
    dependencies: Actions reference task beans, task beans reference UI elements,
    UI elements reference actions. Therefore it is possible to define action
    tasks at an arbitrary position of the builder script. We will meet them
    again at the very bottom of the script.
  </p>
  
<p>
    In the following block the actions are used to construct a popup menu:
  </p>
    
<div class="source">
<pre>
  &lt;!-- Popup menu handler for the append sub menu --&gt;
  &lt;di:bean name=&quot;appendMenu&quot;
    beanClass=&quot;net.sf.jguiraffe.gui.builder.action.SimplePopupMenuHandler&quot;&gt;
    &lt;di:constructor&gt;
      &lt;di:param&gt;
        &lt;di:list&gt;
          &lt;di:element refName=&quot;action:addContentLoremIpsumAction&quot;/&gt;
          &lt;di:element refName=&quot;action:addContentXMLAction&quot;/&gt;
          &lt;di:element refName=&quot;action:addContentHTMLAction&quot;/&gt;
        &lt;/di:list&gt;
      &lt;/di:param&gt;
    &lt;/di:constructor&gt;
    &lt;di:setProperty property=&quot;actionData&quot; refName=&quot;menuAppend&quot;/&gt;
  &lt;/di:bean&gt;

  &lt;!-- Popup menu handler for the text area's content menu --&gt;
  &lt;di:bean name=&quot;fileContentPopupHandler&quot;
    beanClass=&quot;net.sf.jguiraffe.gui.builder.action.SimplePopupMenuHandler&quot;&gt;
    &lt;di:constructor&gt;
      &lt;di:param&gt;
        &lt;di:list&gt;
          &lt;di:element refName=&quot;appendMenu&quot;/&gt;
          &lt;di:element refName=&quot;action:clearContentAction&quot;/&gt;
        &lt;/di:list&gt;
      &lt;/di:param&gt;
    &lt;/di:constructor&gt;
  &lt;/di:bean&gt;
    </pre></div>
  
<p>
    Here two beans of type <code>SimplePopupMenuHandler</code> are defined. The
    one with the name <i>fileContentPopupHandler</i> represents the actual
    popup menu. It consists of a menu item for clearing the text area and a sub
    menu. The sub menu is defined by the other <code>SimplePopupMenuHandler</code>
    bean. Here the actions for inserting text fragments are contained. This is
    all this simple dialog box does with its actions. If you were defining a
    frame window, you could create a main menu as well. A tool bar would be
    created as part of the window definition.
  </p>
  </section>

  <section>
<h3><a name="The_form_controller"></a>The form controller</h3>
  
<p>
    The form controller is a regular bean definition. For this example no
    specific, UI-related logic is needed; therefore we can go with the default
    form controller implementation. The whole declaration looks as follows:
  </p>
    
<div class="source">
<pre>
  &lt;!-- The bean for the form controller.--&gt;
  &lt;di:bean name=&quot;controller&quot;
    beanClass=&quot;net.sf.jguiraffe.gui.builder.window.ctrl.FormController&quot;&gt;
    &lt;di:setProperty property=&quot;btnOkName&quot; value=&quot;btnOk&quot;/&gt;
    &lt;di:setProperty property=&quot;btnCancelName&quot; value=&quot;btnCancel&quot;/&gt;
    &lt;di:setProperty property=&quot;okCommand&quot; refName=&quot;okCommand&quot;/&gt;
  &lt;/di:bean&gt;
    </pre></div>
  
<p>
    Here some important properties of the controller are set: the names of the
    OK and the Cancel buttons, and the command to be executed when the OK button
    is clicked. We have already seen the declaration of the command bean. The
    buttons are defined together with the whole UI of the window in the next
    block.
  </p>
  
<p>
    As we will see in a moment, the controller bean is associated with the
    dialog window as part of the window declaration. Because of that controller
    beans are typically defined before the window. In most cases this is not a
    problem. The <code>FormController</code> class has access to the current
     <code><a href="../apidocs/net/sf/jguiraffe/gui/builder/components/ComponentBuilderData.html">
    ComponentBuilderData</a></code> object, from which all elements defined by
    the builder script can be obtained. If a custom controller implementation
    actually required injection of some UI elements, it is possible to declare
    the controller bean in the body of the tag defining the window - after the
    UI-related tags, and before the tag that connects the controller to the
    window. At this position all UI elements can be referenced.
  </p>
  </section>

  <section>
<h3><a name="The_window_and_its_content"></a>The window and its content</h3>
  
<p>
    The whole dialog window is defined by a <code>&lt;w:dialog&gt;</code> tag.
    In the body of this tag tags of the form builder tag library are placed to
    create the graphical elements comprising the UI. This block looks as follows:
  </p>
    
<div class="source">
<pre>
  &lt;w:dialog titleres=&quot;newfile_title&quot; center=&quot;true&quot; resizable=&quot;true&quot;&gt;
    &lt;f:borderlayout canShrink=&quot;true&quot;/&gt;
    &lt;!-- The main panel --&gt;
    &lt;f:panel&gt;
      &lt;f:borderconstr name=&quot;CENTER&quot;/&gt;
      &lt;f:percentlayout columns=&quot;4dlu start/preferred 3dlu full/preferred(6cm)/100 4dlu&quot;
        rows=&quot;4dlu preferred 3dlu preferred full/preferred(5cm)/100 4dlu&quot;
        canShrink=&quot;true&quot;/&gt;
      &lt;f:label textres=&quot;newfile_lab_name&quot; mnemonicres=&quot;newfile_lab_name_mnemo&quot;
        componentref=&quot;fileName&quot;&gt;
        &lt;f:percentconstr col=&quot;1&quot; row=&quot;1&quot;/&gt;
      &lt;/f:label&gt;
      &lt;f:textfield name=&quot;fileName&quot; displayNameres=&quot;newfile_disp_name&quot;
        maxlength=&quot;200&quot; tooltipres=&quot;newfile_txt_name_tip&quot;&gt;
        &lt;f:percentconstr col=&quot;3&quot; row=&quot;1&quot;/&gt;
        &lt;f:validators phase=&quot;syntax&quot;&gt;
          &lt;f:validator beanName=&quot;requiredValidator&quot;/&gt;
          &lt;f:validator beanName=&quot;fileNameValidator&quot;&gt;
            &lt;f:properties&gt;
              &lt;f:property property=&quot;ERR_PATTERN&quot;&gt;
                &lt;f:localized resid=&quot;ERR_FILENAME_PATTERN&quot;/&gt;
              &lt;/f:property&gt;
            &lt;/f:properties&gt;
          &lt;/f:validator&gt;
          &lt;f:validator
            class=&quot;net.sf.jguiraffe.examples.tutorial.createfile.UniqueFileNameValidator&quot;/&gt;
        &lt;/f:validators&gt;
      &lt;/f:textfield&gt;
      &lt;f:label textres=&quot;newfile_lab_content&quot; mnemonicres=&quot;newfile_lab_content_mnemo&quot;
        componentref=&quot;fileContent&quot;&gt;
        &lt;f:percentconstr col=&quot;1&quot; row=&quot;3&quot;/&gt;
      &lt;/f:label&gt;
      &lt;f:textarea name=&quot;fileContent&quot; displayNameres=&quot;newfile_disp_content&quot;
        rows=&quot;10&quot; columns=&quot;50&quot;&gt;
        &lt;f:percentconstr col=&quot;1&quot; row=&quot;4&quot; spanx=&quot;3&quot; targetCol=&quot;3&quot;/&gt;
        &lt;f:font name=&quot;Monospaced&quot; size=&quot;13&quot;/&gt;
        &lt;f:validator phase=&quot;syntax&quot; beanName=&quot;requiredValidator&quot;&gt;
          &lt;f:properties&gt;
            &lt;f:property property=&quot;errorLevel&quot; value=&quot;WARNING&quot;/&gt;
          &lt;/f:properties&gt;
        &lt;/f:validator&gt;
        &lt;a:popup beanName=&quot;fileContentPopupHandler&quot;/&gt;
      &lt;/f:textarea&gt;
    &lt;/f:panel&gt;

    &lt;!-- The button bar --&gt;
    &lt;f:panel&gt;
      &lt;f:borderconstr name=&quot;SOUTH&quot;/&gt;
      &lt;f:buttonlayout/&gt;
      &lt;f:button name=&quot;btnOk&quot; textres=&quot;newfile_btn_create&quot;
        mnemonicres=&quot;newfile_btn_create_mnemo&quot; command=&quot;create&quot;/&gt;
      &lt;f:button name=&quot;btnCancel&quot; textres=&quot;newfile_btn_cancel&quot;
        mnemonicres=&quot;newfile_btn_cancel_mnemo&quot;/&gt;
    &lt;/f:panel&gt;

    &lt;!-- Connect the form controller --&gt;
    &lt;w:formController beanName=&quot;controller&quot; formBeanName=&quot;createFileModel&quot;&gt;
      &lt;!-- Register the field markers --&gt;
      &lt;w:formControllerListener beanName=&quot;jguiraffe.fieldMarker&quot;/&gt;
    &lt;/w:formController&gt;
  &lt;/w:dialog&gt;
    </pre></div>
  
<p>
    This fragment is a bit longer, but there is not that much to say about it.
    Most of the elements occuring in this script should be familiar after
    reading the chapter <a href="formbuilder.html">Building user interfaces</a>.
    The script specifies the layout to use - a border layout with a main panel
    in the center area and a button panel in the south area; the main panel uses
    a percent layout - and adds the corresponding UI elements to it. Here are a
    few remarks:
    </p>
<ul>
      
<li>The layout used by the implicit panel associated with the window has
      to be defined. In this case, a <a href="layouts.html#BorderLayout">BorderLayout</a>
      is used. Note how layout constraint tags are used to arrange the single
      components comprising the window's content (the main panel in the center,
      and the button bar in the south).</li>
      
<li>The validator definitions are complex in this example, especially for
      the text field for the file name. Here three different validators are set.
      Two of them have been defined in the section
      <a href="builderscript.html#Bean_declarations">Bean declarations</a> and
      are now just referenced. The third one - an instance of the custom
      validator class <code>UniqueFileNameValidator</code> is directly created
      by the <code>&lt;f:validator&gt;</code> tag. This is mainly done for
      demonstration purposes: to show that this way is possible, too. It could
      as well have been defined as a bean as the other validators. However,
      because there is only a single instance of this validator which is
      associated with this text field, it makes sense to define it locally.
      The <code>UniqueFileNameValidator</code> class is not shown here. Its
      purpose is to ensure that the user enters a file name which does not exist
      in the current directory. So it checks the user input against the listing
      of the current directory. Also notice that for some validators specific
      properties are set. These properties override the global settings of the
      validator instance for this specific input field. In this example we set
      a custom error message for the regular expression validator of the text
      field and indicate that the required validator of the text area should
      only produce warning messages.</li>
      
<li>In the button bar the OK and the Cancel button are defined. The names
      of these buttons must match the names specified in the properties of the
      declaration of the form controller as shown in the sub section
      <a href="builderscript.html#The_form_controller">The form controller</a>.
      </li>
      
<li>The <code>&lt;w:formController&gt;</code> tag establishes the
      connection between the dialog window and the form controller. It references
      the controller bean and also specifies the form model. In the body of the
      tag we also add the standard bean <i>jguiraffe.fieldMarker</i> as event
      listener to the form controller. This effectively enables the highlighting
      of input fields containing invalid data.</li>
    </ul>
  
  </section>

  <section>
<h3><a name="Action_tasks"></a>Action tasks</h3>
  
<p>
    After the definition of the window the most important declarations of the
    builder script have been discussed. What remains are elements which
    reference other graphical elements defined so far. Under this category fall
    event listener declarations and the tasks of actions. Remember that we
    already mentioned in the sub section <a href="builderscript.html#Actions_and_menus">
    Actions and menus</a> that action tags can reference task beans that may be
    defined later in the script. Here the action tasks manipulate the text area
    with the content of the new file. Thus a reference to this input element needs to
    be injected. The following listing shows the definitions for the task beans
    for clearing the text area and for inserting text fragments:
  </p>
    
<div class="source">
<pre>
  &lt;di:bean name=&quot;clearTask&quot;
    beanClass=&quot;net.sf.jguiraffe.examples.tutorial.createfile.ClearTextActionTask&quot;&gt;
    &lt;di:constructor&gt;
      &lt;di:param refName=&quot;comp:fileContent&quot;/&gt;
    &lt;/di:constructor&gt;
  &lt;/di:bean&gt;

  &lt;di:bean name=&quot;addLoremIpsumTask&quot;
    beanClass=&quot;net.sf.jguiraffe.examples.tutorial.createfile.AppendTextActionTask&quot;&gt;
    &lt;di:constructor&gt;
      &lt;di:param refName=&quot;comp:fileContent&quot;/&gt;
      &lt;di:param&gt;
        &lt;di:value&gt;
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum quis mauris
in quam mattis dignissim. Integer non nibh purus, vel cursus tortor. Donec quam
orci, tincidunt vitae fringilla vitae, suscipit eu nibh. Etiam fermentum, turpis
ut gravida tempor, nisl lorem malesuada ante, at sodales libero nibh non libero.
Duis vel erat hendrerit neque condimentum imperdiet sit amet id diam. Phasellus
in congue urna. Sed lectus orci, hendrerit eget vehicula sit amet, tempus ac
dui. Aenean nec dolor diam, fermentum venenatis justo. Nunc ac lorem arcu, ut
convallis dui. Nam pretium feugiat felis sit amet consequat. Morbi id nunc
sodales diam pulvinar commodo id ac magna. Donec accumsan rhoncus arcu ut porta.
Donec blandit porta suscipit. Cras sit amet nibh non dui faucibus blandit.
Curabitur tincidunt sagittis neque, ut sagittis magna tempor ut. Vestibulum ante
ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Vivamus
egestas iaculis eleifend. Pellentesque dui lacus, fringilla vulputate tempor eu,
pretium non eros. Ut id eros nibh.
        &lt;/di:value&gt;
      &lt;/di:param&gt;
    &lt;/di:constructor&gt;
  &lt;/di:bean&gt;

  &lt;di:bean name=&quot;addXMLTask&quot;
    beanClass=&quot;net.sf.jguiraffe.examples.tutorial.createfile.AppendTextActionTask&quot;&gt;
    &lt;di:constructor&gt;
      &lt;di:param refName=&quot;comp:fileContent&quot;/&gt;
      &lt;di:param&gt;
        &lt;di:value&gt;&lt;![CDATA[
&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
&lt;root&gt;
&lt;/root&gt;
        ]] &gt;&lt;/di:value&gt;
      &lt;/di:param&gt;
    &lt;/di:constructor&gt;
  &lt;/di:bean&gt;

  &lt;di:bean name=&quot;addHTMLTask&quot;
    beanClass=&quot;net.sf.jguiraffe.examples.tutorial.createfile.AppendTextActionTask&quot;&gt;
    &lt;di:constructor&gt;
      &lt;di:param refName=&quot;comp:fileContent&quot;/&gt;
      &lt;di:param&gt;
        &lt;di:value&gt;&lt;![CDATA[
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;html&gt;
  &lt;head&gt;
  &lt;/head&gt;

  &lt;body&gt;
  &lt;/body&gt;
&lt;/html&gt;
        ]] &gt;&lt;/di:value&gt;
      &lt;/di:param&gt;
    &lt;/di:constructor&gt;
  &lt;/di:bean&gt;
    </pre></div>
  
<p>
    In this example special action task implementation classes are used. The
    classes are not shown here, but they are pretty simple.
    <code>ClearTextActionTask</code> is initialized with a reference to a text
    component handler in its constructor. It simply sets the data of the
    handler to <b>null</b> which clears the content of the text field.
  </p>
  
<p>
    The <code>AppendTextActionTask</code> class is used to append a configurable
    text fragment to the text area. A reference to the component handler of the
    text area and the text fragment to be appended are passed to the constructor.
    When triggered <code>AppendTextActionTask</code> reads the current data of
    the text component handler, appends the text fragment to it, and writes the
    resulting String back into the handler. The fact that the text fragment to
    be appended can be configured in the builder script makes this class pretty
    flexible. However, the declarations tend to become verbose, especially if
    XML fragments are involved which have to be enclosed in <code>CDATA</code>
    sections. In this example three instances of the
    <code>AppendTextActionTask</code> task class are created and initialized
    with different text fragments: one with the famous <i>lorem ipsum</i>
    text, one with a skeleton for an XML document, and one with a skeleton for
    an HTML file. Also note how the references to the text component handlers
    are passed to the constructor: by using the special prefix <i>comp:</i>
    followed by the name of the affected input component.
  </p>
  </section>

  <section>
<h3><a name="Bringing_it_all_together"></a>Bringing it all together</h3>
  
<p>
    We are now complete with our tour through the different sections that can
    occur in a builder script. You should have gained an understanding about
    the order in which elements are best placed in such a script. To give the
    reader a better overview we present the script again as a whole. The
    different sections are marked with comments.
  </p>
    
<div class="source">
<pre>
&lt;j:jelly xmlns:j=&quot;jelly:core&quot; xmlns:di=&quot;diBuilder&quot; xmlns:f=&quot;formBuilder&quot;
  xmlns:a=&quot;actionBuilder&quot; xmlns:w=&quot;windowBuilder&quot;&gt;

  &lt;!-- The form bean. This object acts as the model of the dialog.--&gt;
  &lt;di:bean name=&quot;createFileModel&quot;
    beanClass=&quot;net.sf.jguiraffe.examples.tutorial.createfile.CreateFileData&quot;/&gt;

  &lt;!-- The command to be executed when the OK button is pressed. --&gt;
  &lt;di:bean name=&quot;okCommand&quot;
    beanClass=&quot;net.sf.jguiraffe.examples.tutorial.createfile.CreateFileCommand&quot;&gt;
    &lt;di:constructor&gt;
      &lt;di:param refName=&quot;jguiraffe.applicationContext&quot;/&gt;
      &lt;di:param refName=&quot;createFileModel&quot;/&gt;
      &lt;di:param refName=&quot;action:editRefreshAction&quot;/&gt;
    &lt;/di:constructor&gt;
  &lt;/di:bean&gt;

  &lt;!-- Validators.
       As validators can be shared between components, they can be declared
       globally and then be referenced from the input field declarations.
  --&gt;

  &lt;!-- A validator for required input fields.--&gt;
  &lt;di:bean name=&quot;requiredValidator&quot;
    beanClass=&quot;net.sf.jguiraffe.transform.RequiredValidator&quot;&gt;
  &lt;/di:bean&gt;

  &lt;!-- A regular expression validator for validating a file name. Certain
       characters are not allowed in file names.
  --&gt;
  &lt;di:bean name=&quot;fileNameValidator&quot;
    beanClass=&quot;net.sf.jguiraffe.transform.RegexValidator&quot;&gt;
    &lt;di:setProperty property=&quot;regex&quot; value=&quot;[^\*\\/~\|&amp;lt;&amp;gt;]*&quot;/&gt;
  &lt;/di:bean&gt;

  &lt;!-- Action definitions --&gt;

  &lt;!-- Action for clearing the content text field. --&gt;
  &lt;a:action name=&quot;clearContentAction&quot; textres=&quot;newfile_act_clear_text&quot;
    mnemonicres=&quot;newfile_act_clear_mnemo&quot; taskBean=&quot;clearTask&quot;/&gt;

  &lt;!-- Action for adding lorem ipsum to the content text field. --&gt;
  &lt;a:action name=&quot;addContentLoremIpsumAction&quot; textres=&quot;newfile_act_loremipsum_text&quot;
    mnemonicres=&quot;newfile_act_loremipsum_mnemo&quot; taskBean=&quot;addLoremIpsumTask&quot;/&gt;

  &lt;!-- Action for adding XML to the content text field. --&gt;
  &lt;a:action name=&quot;addContentXMLAction&quot; textres=&quot;newfile_act_xml_text&quot;
    mnemonicres=&quot;newfile_act_xml_mnemo&quot; taskBean=&quot;addXMLTask&quot;/&gt;

  &lt;!-- Action for adding HTML to the content text field. --&gt;
  &lt;a:action name=&quot;addContentHTMLAction&quot; textres=&quot;newfile_act_html_text&quot;
    mnemonicres=&quot;newfile_act_html_mnemo&quot; taskBean=&quot;addHTMLTask&quot;/&gt;

  &lt;!-- Action data definition for the append sub menu in the popup menu --&gt;
  &lt;a:actionData textres=&quot;newfile_men_append_text&quot;
    mnemonicres=&quot;newfile_men_append_mnemo&quot; var=&quot;menuAppend&quot;/&gt;

  &lt;!-- Popup menu handler for the append sub menu --&gt;
  &lt;di:bean name=&quot;appendMenu&quot;
    beanClass=&quot;net.sf.jguiraffe.gui.builder.action.SimplePopupMenuHandler&quot;&gt;
    &lt;di:constructor&gt;
      &lt;di:param&gt;
        &lt;di:list&gt;
          &lt;di:element refName=&quot;action:addContentLoremIpsumAction&quot;/&gt;
          &lt;di:element refName=&quot;action:addContentXMLAction&quot;/&gt;
          &lt;di:element refName=&quot;action:addContentHTMLAction&quot;/&gt;
        &lt;/di:list&gt;
      &lt;/di:param&gt;
    &lt;/di:constructor&gt;
    &lt;di:setProperty property=&quot;actionData&quot; refName=&quot;menuAppend&quot;/&gt;
  &lt;/di:bean&gt;

  &lt;!-- Popup menu handler for the text area's content menu --&gt;
  &lt;di:bean name=&quot;fileContentPopupHandler&quot;
    beanClass=&quot;net.sf.jguiraffe.gui.builder.action.SimplePopupMenuHandler&quot;&gt;
    &lt;di:constructor&gt;
      &lt;di:param&gt;
        &lt;di:list&gt;
          &lt;di:element refName=&quot;appendMenu&quot;/&gt;
          &lt;di:element refName=&quot;action:clearContentAction&quot;/&gt;
        &lt;/di:list&gt;
      &lt;/di:param&gt;
    &lt;/di:constructor&gt;
  &lt;/di:bean&gt;

  &lt;!-- The bean for the form controller.--&gt;
  &lt;di:bean name=&quot;controller&quot;
    beanClass=&quot;net.sf.jguiraffe.gui.builder.window.ctrl.FormController&quot;&gt;
    &lt;di:setProperty property=&quot;btnOkName&quot; value=&quot;btnOk&quot;/&gt;
    &lt;di:setProperty property=&quot;btnCancelName&quot; value=&quot;btnCancel&quot;/&gt;
    &lt;di:setProperty property=&quot;okCommand&quot; refName=&quot;okCommand&quot;/&gt;
  &lt;/di:bean&gt;

  &lt;!-- The dialog window --&gt;
  &lt;w:dialog titleres=&quot;newfile_title&quot; center=&quot;true&quot; resizable=&quot;true&quot;&gt;
    &lt;f:borderlayout canShrink=&quot;true&quot;/&gt;
    &lt;!-- The main panel --&gt;
    &lt;f:panel&gt;
      &lt;f:borderconstr name=&quot;CENTER&quot;/&gt;
      &lt;f:percentlayout columns=&quot;4dlu start/preferred 3dlu full/preferred(6cm)/100 4dlu&quot;
        rows=&quot;4dlu preferred 3dlu preferred full/preferred(5cm)/100 4dlu&quot;
        canShrink=&quot;true&quot;/&gt;
      &lt;f:label textres=&quot;newfile_lab_name&quot; mnemonicres=&quot;newfile_lab_name_mnemo&quot;
        componentref=&quot;fileName&quot;&gt;
        &lt;f:percentconstr col=&quot;1&quot; row=&quot;1&quot;/&gt;
      &lt;/f:label&gt;
      &lt;f:textfield name=&quot;fileName&quot; displayNameres=&quot;newfile_disp_name&quot;
        maxlength=&quot;200&quot; tooltipres=&quot;newfile_txt_name_tip&quot;&gt;
        &lt;f:percentconstr col=&quot;3&quot; row=&quot;1&quot;/&gt;
        &lt;f:validators phase=&quot;syntax&quot;&gt;
          &lt;f:validator beanName=&quot;requiredValidator&quot;/&gt;
          &lt;f:validator beanName=&quot;fileNameValidator&quot;&gt;
            &lt;f:properties&gt;
              &lt;f:property property=&quot;ERR_PATTERN&quot;&gt;
                &lt;f:localized resid=&quot;ERR_FILENAME_PATTERN&quot;/&gt;
              &lt;/f:property&gt;
            &lt;/f:properties&gt;
          &lt;/f:validator&gt;
          &lt;f:validator
            class=&quot;net.sf.jguiraffe.examples.tutorial.createfile.UniqueFileNameValidator&quot;/&gt;
        &lt;/f:validators&gt;
      &lt;/f:textfield&gt;
      &lt;f:label textres=&quot;newfile_lab_content&quot; mnemonicres=&quot;newfile_lab_content_mnemo&quot;
        componentref=&quot;fileContent&quot;&gt;
        &lt;f:percentconstr col=&quot;1&quot; row=&quot;3&quot;/&gt;
      &lt;/f:label&gt;
      &lt;f:textarea name=&quot;fileContent&quot; displayNameres=&quot;newfile_disp_content&quot;
        rows=&quot;10&quot; columns=&quot;50&quot;&gt;
        &lt;f:percentconstr col=&quot;1&quot; row=&quot;4&quot; spanx=&quot;3&quot; targetCol=&quot;3&quot;/&gt;
        &lt;f:font name=&quot;Monospaced&quot; size=&quot;13&quot;/&gt;
        &lt;f:validator phase=&quot;syntax&quot; beanName=&quot;requiredValidator&quot;&gt;
          &lt;f:properties&gt;
            &lt;f:property property=&quot;errorLevel&quot; value=&quot;WARNING&quot;/&gt;
          &lt;/f:properties&gt;
        &lt;/f:validator&gt;
        &lt;a:popup beanName=&quot;fileContentPopupHandler&quot;/&gt;
      &lt;/f:textarea&gt;
    &lt;/f:panel&gt;

    &lt;!-- The button bar --&gt;
    &lt;f:panel&gt;
      &lt;f:borderconstr name=&quot;SOUTH&quot;/&gt;
      &lt;f:buttonlayout/&gt;
      &lt;f:button name=&quot;btnOk&quot; textres=&quot;newfile_btn_create&quot;
        mnemonicres=&quot;newfile_btn_create_mnemo&quot; command=&quot;create&quot;/&gt;
      &lt;f:button name=&quot;btnCancel&quot; textres=&quot;newfile_btn_cancel&quot;
        mnemonicres=&quot;newfile_btn_cancel_mnemo&quot;/&gt;
    &lt;/f:panel&gt;

    &lt;!-- Connect the form controller --&gt;
    &lt;w:formController beanName=&quot;controller&quot; formBeanName=&quot;createFileModel&quot;&gt;
      &lt;!-- Register the field markers --&gt;
      &lt;w:formControllerListener beanName=&quot;jguiraffe.fieldMarker&quot;/&gt;
      &lt;w:formControllerListener beanName=&quot;toolTipMarker&quot;/&gt;
    &lt;/w:formController&gt;
  &lt;/w:dialog&gt;

  &lt;!-- Action task definitions that require references to UI elements --&gt;
  &lt;di:bean name=&quot;clearTask&quot;
    beanClass=&quot;net.sf.jguiraffe.examples.tutorial.createfile.ClearTextActionTask&quot;&gt;
    &lt;di:constructor&gt;
      &lt;di:param refName=&quot;comp:fileContent&quot;/&gt;
    &lt;/di:constructor&gt;
  &lt;/di:bean&gt;

  &lt;di:bean name=&quot;addLoremIpsumTask&quot;
    beanClass=&quot;net.sf.jguiraffe.examples.tutorial.createfile.AppendTextActionTask&quot;&gt;
    &lt;di:constructor&gt;
      &lt;di:param refName=&quot;comp:fileContent&quot;/&gt;
      &lt;di:param&gt;
        &lt;di:value&gt;
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum quis mauris
in quam mattis dignissim. Integer non nibh purus, vel cursus tortor. Donec quam
orci, tincidunt vitae fringilla vitae, suscipit eu nibh. Etiam fermentum, turpis
ut gravida tempor, nisl lorem malesuada ante, at sodales libero nibh non libero.
Duis vel erat hendrerit neque condimentum imperdiet sit amet id diam. Phasellus
in congue urna. Sed lectus orci, hendrerit eget vehicula sit amet, tempus ac
dui. Aenean nec dolor diam, fermentum venenatis justo. Nunc ac lorem arcu, ut
convallis dui. Nam pretium feugiat felis sit amet consequat. Morbi id nunc
sodales diam pulvinar commodo id ac magna. Donec accumsan rhoncus arcu ut porta.
Donec blandit porta suscipit. Cras sit amet nibh non dui faucibus blandit.
Curabitur tincidunt sagittis neque, ut sagittis magna tempor ut. Vestibulum ante
ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Vivamus
egestas iaculis eleifend. Pellentesque dui lacus, fringilla vulputate tempor eu,
pretium non eros. Ut id eros nibh.
        &lt;/di:value&gt;
      &lt;/di:param&gt;
    &lt;/di:constructor&gt;
  &lt;/di:bean&gt;

  &lt;di:bean name=&quot;addXMLTask&quot;
    beanClass=&quot;net.sf.jguiraffe.examples.tutorial.createfile.AppendTextActionTask&quot;&gt;
    &lt;di:constructor&gt;
      &lt;di:param refName=&quot;comp:fileContent&quot;/&gt;
      &lt;di:param&gt;
        &lt;di:value&gt;&lt;![CDATA[
&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
&lt;root&gt;
&lt;/root&gt;
        ]] &gt;&lt;/di:value&gt;
      &lt;/di:param&gt;
    &lt;/di:constructor&gt;
  &lt;/di:bean&gt;

  &lt;di:bean name=&quot;addHTMLTask&quot;
    beanClass=&quot;net.sf.jguiraffe.examples.tutorial.createfile.AppendTextActionTask&quot;&gt;
    &lt;di:constructor&gt;
      &lt;di:param refName=&quot;comp:fileContent&quot;/&gt;
      &lt;di:param&gt;
        &lt;di:value&gt;&lt;![CDATA[
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot;&gt;
&lt;html&gt;
  &lt;head&gt;
  &lt;/head&gt;

  &lt;body&gt;
  &lt;/body&gt;
&lt;/html&gt;
        ]] &gt;&lt;/di:value&gt;
      &lt;/di:param&gt;
    &lt;/di:constructor&gt;
  &lt;/di:bean&gt;
&lt;/j:jelly&gt;
    </pre></div>
  </section>
  </section>



      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2022The JGUIraffe Team.
.      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>